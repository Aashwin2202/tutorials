.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (9 PENDING, 1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+-------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |          lr |
    |---------------------+----------+-------+--------------+------+------+-------------|
    | DEFAULT_fa5ad_00000 | RUNNING  |       |            2 |   16 |  128 | 0.00194578  |
    | DEFAULT_fa5ad_00001 | PENDING  |       |            2 |   32 |    4 | 0.0189631   |
    | DEFAULT_fa5ad_00002 | PENDING  |       |            4 |  128 |  256 | 0.000366143 |
    | DEFAULT_fa5ad_00003 | PENDING  |       |            2 |  128 |   16 | 0.000185881 |
    | DEFAULT_fa5ad_00004 | PENDING  |       |           16 |  128 |  256 | 0.0933954   |
    | DEFAULT_fa5ad_00005 | PENDING  |       |            2 |    8 |  128 | 0.000419009 |
    | DEFAULT_fa5ad_00006 | PENDING  |       |            8 |  256 |   32 | 0.00134442  |
    | DEFAULT_fa5ad_00007 | PENDING  |       |            8 |  256 |   16 | 0.000175081 |
    | DEFAULT_fa5ad_00008 | PENDING  |       |           16 |    8 |  256 | 0.0197942   |
    | DEFAULT_fa5ad_00009 | PENDING  |       |           16 |   16 |  128 | 0.00514913  |
    +---------------------+----------+-------+--------------+------+------+-------------+


    [2m[36m(pid=1884)[0m Files already downloaded and verified
    [2m[36m(pid=1888)[0m Files already downloaded and verified
    [2m[36m(pid=1885)[0m Files already downloaded and verified
    [2m[36m(pid=1868)[0m Files already downloaded and verified
    [2m[36m(pid=1891)[0m Files already downloaded and verified
    [2m[36m(pid=1858)[0m Files already downloaded and verified
    [2m[36m(pid=1895)[0m Files already downloaded and verified
    [2m[36m(pid=1896)[0m Files already downloaded and verified
    [2m[36m(pid=1899)[0m Files already downloaded and verified
    [2m[36m(pid=1889)[0m Files already downloaded and verified
    [2m[36m(pid=1884)[0m Files already downloaded and verified
    [2m[36m(pid=1888)[0m Files already downloaded and verified
    [2m[36m(pid=1885)[0m Files already downloaded and verified
    [2m[36m(pid=1868)[0m Files already downloaded and verified
    [2m[36m(pid=1891)[0m Files already downloaded and verified
    [2m[36m(pid=1858)[0m Files already downloaded and verified
    [2m[36m(pid=1895)[0m Files already downloaded and verified
    [2m[36m(pid=1896)[0m Files already downloaded and verified
    [2m[36m(pid=1899)[0m Files already downloaded and verified
    [2m[36m(pid=1889)[0m Files already downloaded and verified
    [2m[36m(pid=1884)[0m [1,  2000] loss: 2.314
    [2m[36m(pid=1888)[0m [1,  2000] loss: 2.170
    [2m[36m(pid=1895)[0m [1,  2000] loss: 2.290
    [2m[36m(pid=1896)[0m [1,  2000] loss: 2.306
    [2m[36m(pid=1899)[0m [1,  2000] loss: 2.290
    [2m[36m(pid=1891)[0m [1,  2000] loss: 2.307
    [2m[36m(pid=1889)[0m [1,  2000] loss: 2.190
    [2m[36m(pid=1868)[0m [1,  2000] loss: 1.943
    [2m[36m(pid=1858)[0m [1,  2000] loss: 1.843
    [2m[36m(pid=1885)[0m [1,  2000] loss: 2.268
    [2m[36m(pid=1888)[0m [1,  4000] loss: 0.957
    [2m[36m(pid=1895)[0m [1,  4000] loss: 1.054
    [2m[36m(pid=1884)[0m [1,  4000] loss: 1.161
    [2m[36m(pid=1896)[0m [1,  4000] loss: 1.150
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.3392
      date: 2021-10-04_17-10-59
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.771347131729126
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 27.13700532913208
      time_this_iter_s: 27.13700532913208
      time_total_s: 27.13700532913208
      timestamp: 1633367459
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00008
  
    == Status ==
    Memory usage on this node: 9.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.771347131729126
    Resources requested: 20.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING  |                 |            2 |   16 |  128 | 0.00194578  |         |            |                      |
    | DEFAULT_fa5ad_00001 | RUNNING  |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING  |                 |            4 |  128 |  256 | 0.000366143 |         |            |                      |
    | DEFAULT_fa5ad_00003 | RUNNING  |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00004 | RUNNING  |                 |           16 |  128 |  256 | 0.0933954   |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING  |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING  |                 |            8 |  256 |   32 | 0.00134442  |         |            |                      |
    | DEFAULT_fa5ad_00007 | RUNNING  |                 |            8 |  256 |   16 | 0.000175081 |         |            |                      |
    | DEFAULT_fa5ad_00008 | RUNNING  | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.77135 |     0.3392 |                    1 |
    | DEFAULT_fa5ad_00009 | RUNNING  |                 |           16 |   16 |  128 | 0.00514913  |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.4467
      date: 2021-10-04_17-10-59
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.5064361930847168
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 27.722482681274414
      time_this_iter_s: 27.722482681274414
      time_total_s: 27.722482681274414
      timestamp: 1633367459
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1899)[0m [1,  4000] loss: 1.070
    Result for DEFAULT_fa5ad_00004:
      accuracy: 0.0973
      date: 2021-10-04_17-11-02
      done: true
      experiment_id: 947d17a37dc7449ea1591a97ea50296f
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 2.3128136318206787
      node_ip: 172.17.0.2
      pid: 1885
      should_checkpoint: true
      time_since_restore: 29.930567264556885
      time_this_iter_s: 29.930567264556885
      time_total_s: 29.930567264556885
      timestamp: 1633367462
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00004
  
    [2m[36m(pid=1891)[0m [1,  4000] loss: 1.145
    [2m[36m(pid=1889)[0m [1,  4000] loss: 0.863
    [2m[36m(pid=1888)[0m [1,  6000] loss: 0.586
    [2m[36m(pid=1895)[0m [1,  6000] loss: 0.624
    [2m[36m(pid=1884)[0m [1,  6000] loss: 0.775
    [2m[36m(pid=1896)[0m [1,  6000] loss: 0.764
    [2m[36m(pid=1899)[0m [1,  6000] loss: 0.658
    Result for DEFAULT_fa5ad_00007:
      accuracy: 0.1635
      date: 2021-10-04_17-11-13
      done: true
      experiment_id: f70a7a00aa8e40209e9b8a84579d554d
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 2.2415373951911928
      node_ip: 172.17.0.2
      pid: 1891
      should_checkpoint: true
      time_since_restore: 41.46660614013672
      time_this_iter_s: 41.46660614013672
      time_total_s: 41.46660614013672
      timestamp: 1633367473
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00007
  
    == Status ==
    Memory usage on this node: 8.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.0064422634601593
    Resources requested: 18.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (9 RUNNING, 1 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    |                 |            2 |   16 |  128 | 0.00194578  |         |            |                      |
    | DEFAULT_fa5ad_00001 | RUNNING    |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING    |                 |            4 |  128 |  256 | 0.000366143 |         |            |                      |
    | DEFAULT_fa5ad_00003 | RUNNING    |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING    |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING    |                 |            8 |  256 |   32 | 0.00134442  |         |            |                      |
    | DEFAULT_fa5ad_00007 | RUNNING    | 172.17.0.2:1891 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.77135 |     0.3392 |                    1 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.50644 |     0.4467 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1868)[0m [2,  2000] loss: 1.769
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.4401
      date: 2021-10-04_17-11-14
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.541822416782379
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 41.941354274749756
      time_this_iter_s: 41.941354274749756
      time_total_s: 41.941354274749756
      timestamp: 1633367474
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00006
  
    [2m[36m(pid=1888)[0m [1,  8000] loss: 0.426
    [2m[36m(pid=1858)[0m [2,  2000] loss: 1.435
    [2m[36m(pid=1895)[0m [1,  8000] loss: 0.443
    [2m[36m(pid=1884)[0m [1,  8000] loss: 0.581
    [2m[36m(pid=1896)[0m [1,  8000] loss: 0.569
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.3618
      date: 2021-10-04_17-11-19
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 2
      loss: 1.7181483312606811
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 47.4767119884491
      time_this_iter_s: 20.339706659317017
      time_total_s: 47.4767119884491
      timestamp: 1633367479
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: fa5ad_00008
  
    == Status ==
    Memory usage on this node: 8.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.7181483312606811 | Iter 1.000: -1.771347131729126
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    |                 |            2 |   16 |  128 | 0.00194578  |         |            |                      |
    | DEFAULT_fa5ad_00001 | RUNNING    |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING    |                 |            4 |  128 |  256 | 0.000366143 |         |            |                      |
    | DEFAULT_fa5ad_00003 | RUNNING    |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING    |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.54182 |     0.4401 |                    1 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.71815 |     0.3618 |                    2 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.50644 |     0.4467 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5235
      date: 2021-10-04_17-11-20
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 2
      loss: 1.3527821992874145
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 48.174030780792236
      time_this_iter_s: 20.451548099517822
      time_total_s: 48.174030780792236
      timestamp: 1633367480
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1899)[0m [1,  8000] loss: 0.452
    [2m[36m(pid=1888)[0m [1, 10000] loss: 0.335
    [2m[36m(pid=1895)[0m [1, 10000] loss: 0.338
    [2m[36m(pid=1896)[0m [1, 10000] loss: 0.446
    [2m[36m(pid=1884)[0m [1, 10000] loss: 0.465
    [2m[36m(pid=1889)[0m [2,  2000] loss: 1.482
    [2m[36m(pid=1895)[0m [1, 12000] loss: 0.276
    [2m[36m(pid=1899)[0m [1, 10000] loss: 0.339
    [2m[36m(pid=1888)[0m [1, 12000] loss: 0.276
    [2m[36m(pid=1896)[0m [1, 12000] loss: 0.358
    [2m[36m(pid=1868)[0m [3,  2000] loss: 1.774
    [2m[36m(pid=1884)[0m [1, 12000] loss: 0.387
    [2m[36m(pid=1858)[0m [3,  2000] loss: 1.306
    [2m[36m(pid=1889)[0m [2,  4000] loss: 0.709
    Result for DEFAULT_fa5ad_00002:
      accuracy: 0.3816
      date: 2021-10-04_17-11-38
      done: false
      experiment_id: 5594c9c4a796437baafc90cdd0bf152a
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.6959776002526283
      node_ip: 172.17.0.2
      pid: 1899
      should_checkpoint: true
      time_since_restore: 66.0994303226471
      time_this_iter_s: 66.0994303226471
      time_total_s: 66.0994303226471
      timestamp: 1633367498
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00002
  
    == Status ==
    Memory usage on this node: 8.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.535465265274048 | Iter 1.000: -1.7336623659908772
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    |                 |            2 |   16 |  128 | 0.00194578  |         |            |                      |
    | DEFAULT_fa5ad_00001 | RUNNING    |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING    | 172.17.0.2:1899 |            4 |  128 |  256 | 0.000366143 | 1.69598 |     0.3816 |                    1 |
    | DEFAULT_fa5ad_00003 | RUNNING    |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING    |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.54182 |     0.4401 |                    1 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.71815 |     0.3618 |                    2 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.35278 |     0.5235 |                    2 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [1, 14000] loss: 0.230
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.3598
      date: 2021-10-04_17-11-39
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 3
      loss: 1.7170905237197875
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 67.15740323066711
      time_this_iter_s: 19.680691242218018
      time_total_s: 67.15740323066711
      timestamp: 1633367499
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: fa5ad_00008
  
    [2m[36m(pid=1888)[0m [1, 14000] loss: 0.234
    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5556
      date: 2021-10-04_17-11-40
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 3
      loss: 1.2734414476394653
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 67.98331880569458
      time_this_iter_s: 19.809288024902344
      time_total_s: 67.98331880569458
      timestamp: 1633367500
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1896)[0m [1, 14000] loss: 0.294
    [2m[36m(pid=1884)[0m [1, 14000] loss: 0.332
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.5173
      date: 2021-10-04_17-11-47
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 2
      loss: 1.3477790432453156
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 75.09232950210571
      time_this_iter_s: 33.15097522735596
      time_total_s: 75.09232950210571
      timestamp: 1633367507
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 8.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.3527821992874145 | Iter 1.000: -1.7336623659908772
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    |                 |            2 |   16 |  128 | 0.00194578  |         |            |                      |
    | DEFAULT_fa5ad_00001 | RUNNING    |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING    | 172.17.0.2:1899 |            4 |  128 |  256 | 0.000366143 | 1.69598 |     0.3816 |                    1 |
    | DEFAULT_fa5ad_00003 | RUNNING    |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING    |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.34778 |     0.5173 |                    2 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.71709 |     0.3598 |                    3 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.27344 |     0.5556 |                    3 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [1, 16000] loss: 0.197
    [2m[36m(pid=1888)[0m [1, 16000] loss: 0.204
    [2m[36m(pid=1899)[0m [2,  2000] loss: 1.640
    [2m[36m(pid=1896)[0m [1, 16000] loss: 0.244
    [2m[36m(pid=1884)[0m [1, 16000] loss: 0.291
    [2m[36m(pid=1868)[0m [4,  2000] loss: 1.759
    [2m[36m(pid=1858)[0m [4,  2000] loss: 1.243
    [2m[36m(pid=1888)[0m [1, 18000] loss: 0.178
    [2m[36m(pid=1895)[0m [1, 18000] loss: 0.171
    [2m[36m(pid=1899)[0m [2,  4000] loss: 0.795
    [2m[36m(pid=1889)[0m [3,  2000] loss: 1.306
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.3139
      date: 2021-10-04_17-11-59
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 4
      loss: 1.8373235319137573
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 86.99110984802246
      time_this_iter_s: 19.833706617355347
      time_total_s: 86.99110984802246
      timestamp: 1633367519
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: fa5ad_00008
  
    == Status ==
    Memory usage on this node: 8.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: -1.8373235319137573 | Iter 2.000: -1.3527821992874145 | Iter 1.000: -1.7336623659908772
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    |                 |            2 |   16 |  128 | 0.00194578  |         |            |                      |
    | DEFAULT_fa5ad_00001 | RUNNING    |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING    | 172.17.0.2:1899 |            4 |  128 |  256 | 0.000366143 | 1.69598 |     0.3816 |                    1 |
    | DEFAULT_fa5ad_00003 | RUNNING    |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING    |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.34778 |     0.5173 |                    2 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.83732 |     0.3139 |                    4 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.27344 |     0.5556 |                    3 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1896)[0m [1, 18000] loss: 0.210
    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5526
      date: 2021-10-04_17-11-59
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 4
      loss: 1.2585666637420654
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 87.79791450500488
      time_this_iter_s: 19.814595699310303
      time_total_s: 87.79791450500488
      timestamp: 1633367519
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1884)[0m [1, 18000] loss: 0.258
    [2m[36m(pid=1888)[0m [1, 20000] loss: 0.161
    [2m[36m(pid=1895)[0m [1, 20000] loss: 0.152
    [2m[36m(pid=1899)[0m [2,  6000] loss: 0.508
    [2m[36m(pid=1896)[0m [1, 20000] loss: 0.179
    [2m[36m(pid=1884)[0m [1, 20000] loss: 0.232
    [2m[36m(pid=1889)[0m [3,  4000] loss: 0.634
    [2m[36m(pid=1868)[0m [5,  2000] loss: 1.765
    [2m[36m(pid=1858)[0m [5,  2000] loss: 1.196
    Result for DEFAULT_fa5ad_00000:
      accuracy: 0.4172
      date: 2021-10-04_17-12-17
      done: false
      experiment_id: d9280e8cd605477b8713a30387bf71b4
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.6957435384534765
      node_ip: 172.17.0.2
      pid: 1888
      should_checkpoint: true
      time_since_restore: 105.07216334342957
      time_this_iter_s: 105.07216334342957
      time_total_s: 105.07216334342957
      timestamp: 1633367537
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00000
  
    == Status ==
    Memory usage on this node: 8.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: -1.5479450978279115 | Iter 2.000: -1.3527821992874145 | Iter 1.000: -1.6959776002526283
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00001 | RUNNING    |                 |            2 |   32 |    4 | 0.0189631   |         |            |                      |
    | DEFAULT_fa5ad_00002 | RUNNING    | 172.17.0.2:1899 |            4 |  128 |  256 | 0.000366143 | 1.69598 |     0.3816 |                    1 |
    | DEFAULT_fa5ad_00003 | RUNNING    |                 |            2 |  128 |   16 | 0.000185881 |         |            |                      |
    | DEFAULT_fa5ad_00005 | RUNNING    |                 |            2 |    8 |  128 | 0.000419009 |         |            |                      |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.34778 |     0.5173 |                    2 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.83732 |     0.3139 |                    4 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.25857 |     0.5526 |                    4 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00005:
      accuracy: 0.446
      date: 2021-10-04_17-12-17
      done: false
      experiment_id: 3968eea1c7b944a0bde50e6bd106d0e9
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.5338436969012021
      node_ip: 172.17.0.2
      pid: 1895
      should_checkpoint: true
      time_since_restore: 105.16887354850769
      time_this_iter_s: 105.16887354850769
      time_total_s: 105.16887354850769
      timestamp: 1633367537
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00005
  
    [2m[36m(pid=1899)[0m [2,  8000] loss: 0.379
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.3259
      date: 2021-10-04_17-12-19
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 5
      loss: 1.781913733291626
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 107.21355175971985
      time_this_iter_s: 20.222441911697388
      time_total_s: 107.21355175971985
      timestamp: 1633367539
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: fa5ad_00008
  
    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5646
      date: 2021-10-04_17-12-20
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 5
      loss: 1.2567515245437622
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 108.42257905006409
      time_this_iter_s: 20.624664545059204
      time_total_s: 108.42257905006409
      timestamp: 1633367540
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: fa5ad_00009
  
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.5526
      date: 2021-10-04_17-12-20
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 3
      loss: 1.2607800855994225
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 108.74942636489868
      time_this_iter_s: 33.65709686279297
      time_total_s: 108.74942636489868
      timestamp: 1633367540
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: fa5ad_00006
  
    Result for DEFAULT_fa5ad_00003:
      accuracy: 0.3462
      date: 2021-10-04_17-12-21
      done: true
      experiment_id: ac549b3680ed4ccfa64fd565a1d0a1cb
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 1.7785153537213803
      node_ip: 172.17.0.2
      pid: 1896
      should_checkpoint: true
      time_since_restore: 109.57758474349976
      time_this_iter_s: 109.57758474349976
      time_total_s: 109.57758474349976
      timestamp: 1633367541
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00003
  
    Result for DEFAULT_fa5ad_00001:
      accuracy: 0.1016
      date: 2021-10-04_17-12-22
      done: true
      experiment_id: 7c5732647b86425e935f0b0f5d187ed0
      hostname: 2f38447300b4
      iterations_since_restore: 1
      loss: 2.330199113416672
      node_ip: 172.17.0.2
      pid: 1884
      should_checkpoint: true
      time_since_restore: 110.06540870666504
      time_this_iter_s: 110.06540870666504
      time_total_s: 110.06540870666504
      timestamp: 1633367542
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: fa5ad_00001
  
    [2m[36m(pid=1895)[0m [2,  2000] loss: 1.495
    [2m[36m(pid=1888)[0m [2,  2000] loss: 1.565
    [2m[36m(pid=1899)[0m [2, 10000] loss: 0.297
    [2m[36m(pid=1889)[0m [4,  2000] loss: 1.175
    [2m[36m(pid=1868)[0m [6,  2000] loss: 1.820
    [2m[36m(pid=1895)[0m [2,  4000] loss: 0.749
    [2m[36m(pid=1888)[0m [2,  4000] loss: 0.785
    [2m[36m(pid=1858)[0m [6,  2000] loss: 1.169
    Result for DEFAULT_fa5ad_00002:
      accuracy: 0.4603
      date: 2021-10-04_17-12-34
      done: true
      experiment_id: 5594c9c4a796437baafc90cdd0bf152a
      hostname: 2f38447300b4
      iterations_since_restore: 2
      loss: 1.4647286715269088
      node_ip: 172.17.0.2
      pid: 1899
      should_checkpoint: true
      time_since_restore: 122.25076413154602
      time_this_iter_s: 56.151333808898926
      time_total_s: 122.25076413154602
      timestamp: 1633367554
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: fa5ad_00002
  
    == Status ==
    Memory usage on this node: 7.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.5479450978279115 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 12.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00002 | RUNNING    | 172.17.0.2:1899 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.26078 |     0.5526 |                    3 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.78191 |     0.3259 |                    5 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.25675 |     0.5646 |                    5 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.276
      date: 2021-10-04_17-12-38
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 6
      loss: 1.9895751850128174
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 125.9581458568573
      time_this_iter_s: 18.74459409713745
      time_total_s: 125.9581458568573
      timestamp: 1633367558
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: fa5ad_00008
  
    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5878
      date: 2021-10-04_17-12-39
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 6
      loss: 1.1969678559303283
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 127.44853520393372
      time_this_iter_s: 19.02595615386963
      time_total_s: 127.44853520393372
      timestamp: 1633367559
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: fa5ad_00009
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.5479450978279115 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.26078 |     0.5526 |                    3 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.98958 |     0.276  |                    6 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.19697 |     0.5878 |                    6 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [2,  6000] loss: 0.476
    [2m[36m(pid=1888)[0m [2,  6000] loss: 0.517
    [2m[36m(pid=1889)[0m [4,  4000] loss: 0.591
    [2m[36m(pid=1895)[0m [2,  8000] loss: 0.357
    [2m[36m(pid=1888)[0m [2,  8000] loss: 0.393
    [2m[36m(pid=1868)[0m [7,  2000] loss: 1.848
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.5799
      date: 2021-10-04_17-12-51
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 4
      loss: 1.1849324674844741
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 138.89479422569275
      time_this_iter_s: 30.145367860794067
      time_total_s: 138.89479422569275
      timestamp: 1633367571
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.18493 |     0.5799 |                    4 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.98958 |     0.276  |                    6 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.19697 |     0.5878 |                    6 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1858)[0m [7,  2000] loss: 1.149
    [2m[36m(pid=1895)[0m [2, 10000] loss: 0.286
    [2m[36m(pid=1888)[0m [2, 10000] loss: 0.317
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.3184
      date: 2021-10-04_17-12-56
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 7
      loss: 1.9355293533325195
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 144.02205395698547
      time_this_iter_s: 18.063908100128174
      time_total_s: 144.02205395698547
      timestamp: 1633367576
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: fa5ad_00008
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.18493 |     0.5799 |                    4 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.93553 |     0.3184 |                    7 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.19697 |     0.5878 |                    6 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5784
      date: 2021-10-04_17-12-58
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 7
      loss: 1.234476951122284
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 145.92416667938232
      time_this_iter_s: 18.47563147544861
      time_total_s: 145.92416667938232
      timestamp: 1633367578
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1889)[0m [5,  2000] loss: 1.100
    [2m[36m(pid=1895)[0m [2, 12000] loss: 0.236
    [2m[36m(pid=1888)[0m [2, 12000] loss: 0.262
    [2m[36m(pid=1868)[0m [8,  2000] loss: 1.873
    [2m[36m(pid=1895)[0m [2, 14000] loss: 0.199
    [2m[36m(pid=1858)[0m [8,  2000] loss: 1.134
    [2m[36m(pid=1888)[0m [2, 14000] loss: 0.226
    [2m[36m(pid=1889)[0m [5,  4000] loss: 0.546
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.2886
      date: 2021-10-04_17-13-14
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 8
      loss: 1.914408052444458
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 162.79144191741943
      time_this_iter_s: 18.76938796043396
      time_total_s: 162.79144191741943
      timestamp: 1633367594
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: fa5ad_00008
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -1.914408052444458 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.18493 |     0.5799 |                    4 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.91441 |     0.2886 |                    8 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.23448 |     0.5784 |                    7 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5601
      date: 2021-10-04_17-13-16
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 8
      loss: 1.2804477711200715
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 164.064599275589
      time_this_iter_s: 18.140432596206665
      time_total_s: 164.064599275589
      timestamp: 1633367596
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1895)[0m [2, 16000] loss: 0.174
    [2m[36m(pid=1888)[0m [2, 16000] loss: 0.192
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.5811
      date: 2021-10-04_17-13-21
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 5
      loss: 1.2234655052900314
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 169.10497736930847
      time_this_iter_s: 30.210183143615723
      time_total_s: 169.10497736930847
      timestamp: 1633367601
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -1.5974279117822647 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.22347 |     0.5811 |                    5 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 1.91441 |     0.2886 |                    8 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.28045 |     0.5601 |                    8 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [2, 18000] loss: 0.150
    [2m[36m(pid=1888)[0m [2, 18000] loss: 0.173
    [2m[36m(pid=1868)[0m [9,  2000] loss: 1.908
    [2m[36m(pid=1858)[0m [9,  2000] loss: 1.125
    [2m[36m(pid=1889)[0m [6,  2000] loss: 1.019
    [2m[36m(pid=1895)[0m [2, 20000] loss: 0.140
    [2m[36m(pid=1888)[0m [2, 20000] loss: 0.161
    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.2493
      date: 2021-10-04_17-13-33
      done: false
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 9
      loss: 2.2027954027175904
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 181.16212463378906
      time_this_iter_s: 18.37068271636963
      time_total_s: 181.16212463378906
      timestamp: 1633367613
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: fa5ad_00008
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -1.5974279117822647 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4087554354071616 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.53384 |     0.446  |                    1 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.22347 |     0.5811 |                    5 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 2.2028  |     0.2493 |                    9 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.28045 |     0.5601 |                    8 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.5721
      date: 2021-10-04_17-13-34
      done: false
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 9
      loss: 1.2859069539546966
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 182.63505268096924
      time_this_iter_s: 18.57045340538025
      time_total_s: 182.63505268096924
      timestamp: 1633367614
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1889)[0m [6,  4000] loss: 0.506
    Result for DEFAULT_fa5ad_00005:
      accuracy: 0.5048
      date: 2021-10-04_17-13-43
      done: false
      experiment_id: 3968eea1c7b944a0bde50e6bd106d0e9
      hostname: 2f38447300b4
      iterations_since_restore: 2
      loss: 1.3580824007693677
      node_ip: 172.17.0.2
      pid: 1895
      should_checkpoint: true
      time_since_restore: 191.24291563034058
      time_this_iter_s: 86.07404208183289
      time_total_s: 191.24291563034058
      timestamp: 1633367623
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: fa5ad_00005
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: -1.5974279117822647 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.3580824007693677 | Iter 1.000: -1.7336623659908772
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | RUNNING    | 172.17.0.2:1888 |            2 |   16 |  128 | 0.00194578  | 1.69574 |     0.4172 |                    1 |
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.35808 |     0.5048 |                    2 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.22347 |     0.5811 |                    5 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 2.2028  |     0.2493 |                    9 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.28591 |     0.5721 |                    9 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00000:
      accuracy: 0.4302
      date: 2021-10-04_17-13-44
      done: true
      experiment_id: d9280e8cd605477b8713a30387bf71b4
      hostname: 2f38447300b4
      iterations_since_restore: 2
      loss: 1.5673892969315872
      node_ip: 172.17.0.2
      pid: 1888
      should_checkpoint: true
      time_since_restore: 192.4417905807495
      time_this_iter_s: 87.36962723731995
      time_total_s: 192.4417905807495
      timestamp: 1633367624
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: fa5ad_00000
  
    [2m[36m(pid=1868)[0m [10,  2000] loss: 1.909
    [2m[36m(pid=1858)[0m [10,  2000] loss: 1.105
    [2m[36m(pid=1895)[0m [3,  2000] loss: 1.327
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.5928
      date: 2021-10-04_17-13-51
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 6
      loss: 1.167290878891945
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 199.412118434906
      time_this_iter_s: 30.307141065597534
      time_total_s: 199.412118434906
      timestamp: 1633367631
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 5.8/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: -1.5974279117822647 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 8.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.35808 |     0.5048 |                    2 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.16729 |     0.5928 |                    6 |
    | DEFAULT_fa5ad_00008 | RUNNING    | 172.17.0.2:1868 |           16 |    8 |  256 | 0.0197942   | 2.2028  |     0.2493 |                    9 |
    | DEFAULT_fa5ad_00009 | RUNNING    | 172.17.0.2:1858 |           16 |   16 |  128 | 0.00514913  | 1.28591 |     0.5721 |                    9 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_fa5ad_00008:
      accuracy: 0.1861
      date: 2021-10-04_17-13-51
      done: true
      experiment_id: 1160fd5c0bcc4d4ca58ce892c570dad2
      hostname: 2f38447300b4
      iterations_since_restore: 10
      loss: 2.0759801210403444
      node_ip: 172.17.0.2
      pid: 1868
      should_checkpoint: true
      time_since_restore: 199.3926396369934
      time_this_iter_s: 18.230515003204346
      time_total_s: 199.3926396369934
      timestamp: 1633367631
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: fa5ad_00008
  
    Result for DEFAULT_fa5ad_00009:
      accuracy: 0.575
      date: 2021-10-04_17-13-53
      done: true
      experiment_id: 9356ee80ba5f4f03a2a81eaff41a98e2
      hostname: 2f38447300b4
      iterations_since_restore: 10
      loss: 1.2570026238441467
      node_ip: 172.17.0.2
      pid: 1858
      should_checkpoint: true
      time_since_restore: 201.34361577033997
      time_this_iter_s: 18.708563089370728
      time_total_s: 201.34361577033997
      timestamp: 1633367633
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: fa5ad_00009
  
    [2m[36m(pid=1895)[0m [3,  4000] loss: 0.659
    [2m[36m(pid=1889)[0m [7,  2000] loss: 0.938
    [2m[36m(pid=1895)[0m [3,  6000] loss: 0.447
    [2m[36m(pid=1895)[0m [3,  8000] loss: 0.336
    [2m[36m(pid=1889)[0m [7,  4000] loss: 0.480
    [2m[36m(pid=1895)[0m [3, 10000] loss: 0.267
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.5908
      date: 2021-10-04_17-14-19
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 7
      loss: 1.2004895750880242
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 227.78946113586426
      time_this_iter_s: 28.377342700958252
      time_total_s: 227.78946113586426
      timestamp: 1633367659
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.5974279117822647 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.35808 |     0.5048 |                    2 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.20049 |     0.5908 |                    7 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |                 |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |                 |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [3, 12000] loss: 0.215
    [2m[36m(pid=1889)[0m [8,  2000] loss: 0.874
    [2m[36m(pid=1895)[0m [3, 14000] loss: 0.190
    [2m[36m(pid=1895)[0m [3, 16000] loss: 0.159
    [2m[36m(pid=1889)[0m [8,  4000] loss: 0.448
    [2m[36m(pid=1895)[0m [3, 18000] loss: 0.142
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.6103
      date: 2021-10-04_17-14-48
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 8
      loss: 1.1411687388300895
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 256.6095278263092
      time_this_iter_s: 28.820066690444946
      time_total_s: 256.6095278263092
      timestamp: 1633367688
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2804477711200715 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.35808 |     0.5048 |                    2 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.14117 |     0.6103 |                    8 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |                 |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |                 |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [3, 20000] loss: 0.129
    [2m[36m(pid=1889)[0m [9,  2000] loss: 0.803
    Result for DEFAULT_fa5ad_00005:
      accuracy: 0.5377
      date: 2021-10-04_17-15-02
      done: false
      experiment_id: 3968eea1c7b944a0bde50e6bd106d0e9
      hostname: 2f38447300b4
      iterations_since_restore: 3
      loss: 1.2676572706956417
      node_ip: 172.17.0.2
      pid: 1895
      should_checkpoint: true
      time_since_restore: 270.7720091342926
      time_this_iter_s: 79.52909350395203
      time_total_s: 270.7720091342926
      timestamp: 1633367702
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: fa5ad_00005
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2804477711200715 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.26766 |     0.5377 |                    3 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.14117 |     0.6103 |                    8 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |                 |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |                 |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1889)[0m [9,  4000] loss: 0.429
    [2m[36m(pid=1895)[0m [4,  2000] loss: 1.270
    [2m[36m(pid=1895)[0m [4,  4000] loss: 0.635
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.6061
      date: 2021-10-04_17-15-16
      done: false
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 9
      loss: 1.1882024956703185
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 284.84862875938416
      time_this_iter_s: 28.23910093307495
      time_total_s: 284.84862875938416
      timestamp: 1633367716
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.2804477711200715 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.26766 |     0.5377 |                    3 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.1882  |     0.6061 |                    9 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |                 |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |                 |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [4,  6000] loss: 0.419
    [2m[36m(pid=1889)[0m [10,  2000] loss: 0.764
    [2m[36m(pid=1895)[0m [4,  8000] loss: 0.310
    [2m[36m(pid=1889)[0m [10,  4000] loss: 0.400
    [2m[36m(pid=1895)[0m [4, 10000] loss: 0.255
    [2m[36m(pid=1895)[0m [4, 12000] loss: 0.209
    Result for DEFAULT_fa5ad_00006:
      accuracy: 0.6181
      date: 2021-10-04_17-15-45
      done: true
      experiment_id: 1ba005192c6242a08683443b4be03376
      hostname: 2f38447300b4
      iterations_since_restore: 10
      loss: 1.1809661267995835
      node_ip: 172.17.0.2
      pid: 1889
      should_checkpoint: true
      time_since_restore: 313.2754728794098
      time_this_iter_s: 28.426844120025635
      time_total_s: 313.2754728794098
      timestamp: 1633367745
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: fa5ad_00006
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.2804477711200715 | Iter 4.000: -1.2585666637420654 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.26766 |     0.5377 |                    3 |
    | DEFAULT_fa5ad_00006 | RUNNING    | 172.17.0.2:1889 |            8 |  256 |   32 | 0.00134442  | 1.18097 |     0.6181 |                   10 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |                 |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |                 |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1895)[0m [4, 14000] loss: 0.175
    [2m[36m(pid=1895)[0m [4, 16000] loss: 0.159
    [2m[36m(pid=1895)[0m [4, 18000] loss: 0.139
    [2m[36m(pid=1895)[0m [4, 20000] loss: 0.123
    Result for DEFAULT_fa5ad_00005:
      accuracy: 0.5306
      date: 2021-10-04_17-16-20
      done: true
      experiment_id: 3968eea1c7b944a0bde50e6bd106d0e9
      hostname: 2f38447300b4
      iterations_since_restore: 4
      loss: 1.307933256137371
      node_ip: 172.17.0.2
      pid: 1895
      should_checkpoint: true
      time_since_restore: 348.6802988052368
      time_this_iter_s: 77.90828967094421
      time_total_s: 348.6802988052368
      timestamp: 1633367780
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: fa5ad_00005
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.2804477711200715 | Iter 4.000: -1.2832499599397182 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00005 | RUNNING    | 172.17.0.2:1895 |            2 |    8 |  128 | 0.000419009 | 1.30793 |     0.5306 |                    4 |
    | DEFAULT_fa5ad_00000 | TERMINATED |                 |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |                 |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |                 |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |                 |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |                 |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.00134442  | 1.18097 |     0.6181 |                   10 |
    | DEFAULT_fa5ad_00007 | TERMINATED |                 |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |                 |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |                 |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 3.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.2804477711200715 | Iter 4.000: -1.2832499599397182 | Iter 2.000: -1.4114055361481381 | Iter 1.000: -1.7336623659908772
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/220.16 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-10-04_17-10-30
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_fa5ad_00000 | TERMINATED |       |            2 |   16 |  128 | 0.00194578  | 1.56739 |     0.4302 |                    2 |
    | DEFAULT_fa5ad_00001 | TERMINATED |       |            2 |   32 |    4 | 0.0189631   | 2.3302  |     0.1016 |                    1 |
    | DEFAULT_fa5ad_00002 | TERMINATED |       |            4 |  128 |  256 | 0.000366143 | 1.46473 |     0.4603 |                    2 |
    | DEFAULT_fa5ad_00003 | TERMINATED |       |            2 |  128 |   16 | 0.000185881 | 1.77852 |     0.3462 |                    1 |
    | DEFAULT_fa5ad_00004 | TERMINATED |       |           16 |  128 |  256 | 0.0933954   | 2.31281 |     0.0973 |                    1 |
    | DEFAULT_fa5ad_00005 | TERMINATED |       |            2 |    8 |  128 | 0.000419009 | 1.30793 |     0.5306 |                    4 |
    | DEFAULT_fa5ad_00006 | TERMINATED |       |            8 |  256 |   32 | 0.00134442  | 1.18097 |     0.6181 |                   10 |
    | DEFAULT_fa5ad_00007 | TERMINATED |       |            8 |  256 |   16 | 0.000175081 | 2.24154 |     0.1635 |                    1 |
    | DEFAULT_fa5ad_00008 | TERMINATED |       |           16 |    8 |  256 | 0.0197942   | 2.07598 |     0.1861 |                   10 |
    | DEFAULT_fa5ad_00009 | TERMINATED |       |           16 |   16 |  128 | 0.00514913  | 1.257   |     0.575  |                   10 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 256, 'l2': 32, 'lr': 0.0013444216038646633, 'batch_size': 8}
    Best trial final validation loss: 1.1809661267995835
    Best trial final validation accuracy: 0.6181
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.6242


If you run the code, an example output could look like this:

::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 6 minutes  12.672 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
