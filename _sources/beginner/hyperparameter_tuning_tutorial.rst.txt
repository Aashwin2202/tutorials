.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_beginner_hyperparameter_tuning_tutorial.py:


Hyperparameter tuning with Ray Tune
===================================

Hyperparameter tuning can make the difference between an average model and a highly
accurate one. Often simple things like choosing a different learning rate or changing
a network layer size can have a dramatic impact on your model performance.

Fortunately, there are tools that help with finding the best combination of parameters.
`Ray Tune <https://docs.ray.io/en/latest/tune.html>`_ is an industry standard tool for
distributed hyperparameter tuning. Ray Tune includes the latest hyperparameter search
algorithms, integrates with TensorBoard and other analysis libraries, and natively
supports distributed training through `Ray's distributed machine learning engine
<https://ray.io/>`_.

In this tutorial, we will show you how to integrate Ray Tune into your PyTorch
training workflow. We will extend `this tutorial from the PyTorch documentation
<https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_ for training
a CIFAR10 image classifier.

As you will see, we only need to add some slight modifications. In particular, we
need to

1. wrap data loading and training in functions,
2. make some network parameters configurable,
3. add checkpointing (optional),
4. and define the search space for the model tuning

|

To run this tutorial, please make sure the following packages are
installed:

-  ``ray[tune]``: Distributed hyperparameter tuning library
-  ``torchvision``: For the data transformers

Setup / Imports
---------------
Let's start with the imports:


.. code-block:: default

    from functools import partial
    import numpy as np
    import os
    import torch
    import torch.nn as nn
    import torch.nn.functional as F
    import torch.optim as optim
    from torch.utils.data import random_split
    import torchvision
    import torchvision.transforms as transforms
    from ray import tune
    from ray.tune import CLIReporter
    from ray.tune.schedulers import ASHAScheduler







Most of the imports are needed for building the PyTorch model. Only the last three
imports are for Ray Tune.

Data loaders
------------
We wrap the data loaders in their own function and pass a global data directory.
This way we can share a data directory between different trials.


.. code-block:: default



    def load_data(data_dir="./data"):
        transform = transforms.Compose([
            transforms.ToTensor(),
            transforms.Normalize((0.5, 0.5, 0.5), (0.5, 0.5, 0.5))
        ])

        trainset = torchvision.datasets.CIFAR10(
            root=data_dir, train=True, download=True, transform=transform)

        testset = torchvision.datasets.CIFAR10(
            root=data_dir, train=False, download=True, transform=transform)

        return trainset, testset







Configurable neural network
---------------------------
We can only tune those parameters that are configurable. In this example, we can specify
the layer sizes of the fully connected layers:


.. code-block:: default



    class Net(nn.Module):
        def __init__(self, l1=120, l2=84):
            super(Net, self).__init__()
            self.conv1 = nn.Conv2d(3, 6, 5)
            self.pool = nn.MaxPool2d(2, 2)
            self.conv2 = nn.Conv2d(6, 16, 5)
            self.fc1 = nn.Linear(16 * 5 * 5, l1)
            self.fc2 = nn.Linear(l1, l2)
            self.fc3 = nn.Linear(l2, 10)

        def forward(self, x):
            x = self.pool(F.relu(self.conv1(x)))
            x = self.pool(F.relu(self.conv2(x)))
            x = x.view(-1, 16 * 5 * 5)
            x = F.relu(self.fc1(x))
            x = F.relu(self.fc2(x))
            x = self.fc3(x)
            return x







The train function
------------------
Now it gets interesting, because we introduce some changes to the example `from the PyTorch
documentation <https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html>`_.

We wrap the training script in a function ``train_cifar(config, checkpoint_dir=None, data_dir=None)``.
As you can guess, the ``config`` parameter will receive the hyperparameters we would like to
train with. The ``checkpoint_dir`` parameter is used to restore checkpoints. The ``data_dir`` specifies
the directory where we load and store the data, so multiple runs can share the same data source.

.. code-block:: python

    net = Net(config["l1"], config["l2"])

    if checkpoint_dir:
        model_state, optimizer_state = torch.load(
            os.path.join(checkpoint_dir, "checkpoint"))
        net.load_state_dict(model_state)
        optimizer.load_state_dict(optimizer_state)

The learning rate of the optimizer is made configurable, too:

.. code-block:: python

    optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

We also split the training data into a training and validation subset. We thus train on
80% of the data and calculate the validation loss on the remaining 20%. The batch sizes
with which we iterate through the training and test sets are configurable as well.

Adding (multi) GPU support with DataParallel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Image classification benefits largely from GPUs. Luckily, we can continue to use
PyTorch's abstractions in Ray Tune. Thus, we can wrap our model in ``nn.DataParallel``
to support data parallel training on multiple GPUs:

.. code-block:: python

    device = "cpu"
    if torch.cuda.is_available():
        device = "cuda:0"
        if torch.cuda.device_count() > 1:
            net = nn.DataParallel(net)
    net.to(device)

By using a ``device`` variable we make sure that training also works when we have
no GPUs available. PyTorch requires us to send our data to the GPU memory explicitly,
like this:

.. code-block:: python

    for i, data in enumerate(trainloader, 0):
        inputs, labels = data
        inputs, labels = inputs.to(device), labels.to(device)

The code now supports training on CPUs, on a single GPU, and on multiple GPUs. Notably, Ray
also supports `fractional GPUs <https://docs.ray.io/en/master/using-ray-with-gpus.html#fractional-gpus>`_
so we can share GPUs among trials, as long as the model still fits on the GPU memory. We'll come back
to that later.

Communicating with Ray Tune
~~~~~~~~~~~~~~~~~~~~~~~~~~~

The most interesting part is the communication with Ray Tune:

.. code-block:: python

    with tune.checkpoint_dir(epoch) as checkpoint_dir:
        path = os.path.join(checkpoint_dir, "checkpoint")
        torch.save((net.state_dict(), optimizer.state_dict()), path)

    tune.report(loss=(val_loss / val_steps), accuracy=correct / total)

Here we first save a checkpoint and then report some metrics back to Ray Tune. Specifically,
we send the validation loss and accuracy back to Ray Tune. Ray Tune can then use these metrics
to decide which hyperparameter configuration lead to the best results. These metrics
can also be used to stop bad performing trials early in order to avoid wasting
resources on those trials.

The checkpoint saving is optional, however, it is necessary if we wanted to use advanced
schedulers like
`Population Based Training <https://docs.ray.io/en/master/tune/tutorials/tune-advanced-tutorial.html>`_.
Also, by saving the checkpoint we can later load the trained models and validate them
on a test set.

Full training function
~~~~~~~~~~~~~~~~~~~~~~

The full code example looks like this:


.. code-block:: default



    def train_cifar(config, checkpoint_dir=None, data_dir=None):
        net = Net(config["l1"], config["l2"])

        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if torch.cuda.device_count() > 1:
                net = nn.DataParallel(net)
        net.to(device)

        criterion = nn.CrossEntropyLoss()
        optimizer = optim.SGD(net.parameters(), lr=config["lr"], momentum=0.9)

        if checkpoint_dir:
            model_state, optimizer_state = torch.load(
                os.path.join(checkpoint_dir, "checkpoint"))
            net.load_state_dict(model_state)
            optimizer.load_state_dict(optimizer_state)

        trainset, testset = load_data(data_dir)

        test_abs = int(len(trainset) * 0.8)
        train_subset, val_subset = random_split(
            trainset, [test_abs, len(trainset) - test_abs])

        trainloader = torch.utils.data.DataLoader(
            train_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)
        valloader = torch.utils.data.DataLoader(
            val_subset,
            batch_size=int(config["batch_size"]),
            shuffle=True,
            num_workers=8)

        for epoch in range(10):  # loop over the dataset multiple times
            running_loss = 0.0
            epoch_steps = 0
            for i, data in enumerate(trainloader, 0):
                # get the inputs; data is a list of [inputs, labels]
                inputs, labels = data
                inputs, labels = inputs.to(device), labels.to(device)

                # zero the parameter gradients
                optimizer.zero_grad()

                # forward + backward + optimize
                outputs = net(inputs)
                loss = criterion(outputs, labels)
                loss.backward()
                optimizer.step()

                # print statistics
                running_loss += loss.item()
                epoch_steps += 1
                if i % 2000 == 1999:  # print every 2000 mini-batches
                    print("[%d, %5d] loss: %.3f" % (epoch + 1, i + 1,
                                                    running_loss / epoch_steps))
                    running_loss = 0.0

            # Validation loss
            val_loss = 0.0
            val_steps = 0
            total = 0
            correct = 0
            for i, data in enumerate(valloader, 0):
                with torch.no_grad():
                    inputs, labels = data
                    inputs, labels = inputs.to(device), labels.to(device)

                    outputs = net(inputs)
                    _, predicted = torch.max(outputs.data, 1)
                    total += labels.size(0)
                    correct += (predicted == labels).sum().item()

                    loss = criterion(outputs, labels)
                    val_loss += loss.cpu().numpy()
                    val_steps += 1

            with tune.checkpoint_dir(epoch) as checkpoint_dir:
                path = os.path.join(checkpoint_dir, "checkpoint")
                torch.save((net.state_dict(), optimizer.state_dict()), path)

            tune.report(loss=(val_loss / val_steps), accuracy=correct / total)
        print("Finished Training")







As you can see, most of the code is adapted directly from the original example.

Test set accuracy
-----------------
Commonly the performance of a machine learning model is tested on a hold-out test
set with data that has not been used for training the model. We also wrap this in a
function:


.. code-block:: default



    def test_accuracy(net, device="cpu"):
        trainset, testset = load_data()

        testloader = torch.utils.data.DataLoader(
            testset, batch_size=4, shuffle=False, num_workers=2)

        correct = 0
        total = 0
        with torch.no_grad():
            for data in testloader:
                images, labels = data
                images, labels = images.to(device), labels.to(device)
                outputs = net(images)
                _, predicted = torch.max(outputs.data, 1)
                total += labels.size(0)
                correct += (predicted == labels).sum().item()

        return correct / total







The function also expects a ``device`` parameter, so we can do the
test set validation on a GPU.

Configuring the search space
----------------------------
Lastly, we need to define Ray Tune's search space. Here is an example:

.. code-block:: python

    config = {
        "l1": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "l2": tune.sample_from(lambda _: 2**np.random.randint(2, 9)),
        "lr": tune.loguniform(1e-4, 1e-1),
        "batch_size": tune.choice([2, 4, 8, 16])
    }

The ``tune.sample_from()`` function makes it possible to define your own sample
methods to obtain hyperparameters. In this example, the ``l1`` and ``l2`` parameters
should be powers of 2 between 4 and 256, so either 4, 8, 16, 32, 64, 128, or 256.
The ``lr`` (learning rate) should be uniformly sampled between 0.0001 and 0.1. Lastly,
the batch size is a choice between 2, 4, 8, and 16.

At each trial, Ray Tune will now randomly sample a combination of parameters from these
search spaces. It will then train a number of models in parallel and find the best
performing one among these. We also use the ``ASHAScheduler`` which will terminate bad
performing trials early.

We wrap the ``train_cifar`` function with ``functools.partial`` to set the constant
``data_dir`` parameter. We can also tell Ray Tune what resources should be
available for each trial:

.. code-block:: python

    gpus_per_trial = 2
    # ...
    result = tune.run(
        partial(train_cifar, data_dir=data_dir),
        resources_per_trial={"cpu": 8, "gpu": gpus_per_trial},
        config=config,
        num_samples=num_samples,
        scheduler=scheduler,
        progress_reporter=reporter,
        checkpoint_at_end=True)

You can specify the number of CPUs, which are then available e.g.
to increase the ``num_workers`` of the PyTorch ``DataLoader`` instances. The selected
number of GPUs are made visible to PyTorch in each trial. Trials do not have access to
GPUs that haven't been requested for them - so you don't have to care about two trials
using the same set of resources.

Here we can also specify fractional GPUs, so something like ``gpus_per_trial=0.5`` is
completely valid. The trials will then share GPUs among each other.
You just have to make sure that the models still fit in the GPU memory.

After training the models, we will find the best performing one and load the trained
network from the checkpoint file. We then obtain the test set accuracy and report
everything by printing.

The full main function looks like this:


.. code-block:: default



    def main(num_samples=10, max_num_epochs=10, gpus_per_trial=2):
        data_dir = os.path.abspath("./data")
        load_data(data_dir)
        config = {
            "l1": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "l2": tune.sample_from(lambda _: 2 ** np.random.randint(2, 9)),
            "lr": tune.loguniform(1e-4, 1e-1),
            "batch_size": tune.choice([2, 4, 8, 16])
        }
        scheduler = ASHAScheduler(
            metric="loss",
            mode="min",
            max_t=max_num_epochs,
            grace_period=1,
            reduction_factor=2)
        reporter = CLIReporter(
            # parameter_columns=["l1", "l2", "lr", "batch_size"],
            metric_columns=["loss", "accuracy", "training_iteration"])
        result = tune.run(
            partial(train_cifar, data_dir=data_dir),
            resources_per_trial={"cpu": 2, "gpu": gpus_per_trial},
            config=config,
            num_samples=num_samples,
            scheduler=scheduler,
            progress_reporter=reporter)

        best_trial = result.get_best_trial("loss", "min", "last")
        print("Best trial config: {}".format(best_trial.config))
        print("Best trial final validation loss: {}".format(
            best_trial.last_result["loss"]))
        print("Best trial final validation accuracy: {}".format(
            best_trial.last_result["accuracy"]))

        best_trained_model = Net(best_trial.config["l1"], best_trial.config["l2"])
        device = "cpu"
        if torch.cuda.is_available():
            device = "cuda:0"
            if gpus_per_trial > 1:
                best_trained_model = nn.DataParallel(best_trained_model)
        best_trained_model.to(device)

        best_checkpoint_dir = best_trial.checkpoint.value
        model_state, optimizer_state = torch.load(os.path.join(
            best_checkpoint_dir, "checkpoint"))
        best_trained_model.load_state_dict(model_state)

        test_acc = test_accuracy(best_trained_model, device)
        print("Best trial test set accuracy: {}".format(test_acc))


    if __name__ == "__main__":
        # You can change the number of GPUs per trial here:
        main(num_samples=10, max_num_epochs=10, gpus_per_trial=0)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Downloading https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz
    Extracting /var/lib/jenkins/workspace/beginner_source/data/cifar-10-python.tar.gz to /var/lib/jenkins/workspace/beginner_source/data
    Files already downloaded and verified
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (9 PENDING, 1 RUNNING)
    +---------------------+----------+-------+--------------+------+------+-------------+
    | Trial name          | status   | loc   |   batch_size |   l1 |   l2 |          lr |
    |---------------------+----------+-------+--------------+------+------+-------------|
    | DEFAULT_453e7_00000 | RUNNING  |       |            2 |   32 |    4 | 0.00154224  |
    | DEFAULT_453e7_00001 | PENDING  |       |           16 |    4 |  256 | 0.0148798   |
    | DEFAULT_453e7_00002 | PENDING  |       |           16 |   32 |    4 | 0.000805139 |
    | DEFAULT_453e7_00003 | PENDING  |       |           16 |    4 |    8 | 0.000341209 |
    | DEFAULT_453e7_00004 | PENDING  |       |            2 |   16 |  256 | 0.015179    |
    | DEFAULT_453e7_00005 | PENDING  |       |            2 |   32 |   16 | 0.0693658   |
    | DEFAULT_453e7_00006 | PENDING  |       |            8 |  256 |   32 | 0.0254171   |
    | DEFAULT_453e7_00007 | PENDING  |       |            8 |  256 |   32 | 0.0275459   |
    | DEFAULT_453e7_00008 | PENDING  |       |           16 |  128 |  256 | 0.000395593 |
    | DEFAULT_453e7_00009 | PENDING  |       |            8 |    8 |   32 | 0.00910716  |
    +---------------------+----------+-------+--------------+------+------+-------------+


    [2m[36m(pid=1501)[0m Files already downloaded and verified
    [2m[36m(pid=1492)[0m Files already downloaded and verified
    [2m[36m(pid=1489)[0m Files already downloaded and verified
    [2m[36m(pid=1462)[0m Files already downloaded and verified
    [2m[36m(pid=1502)[0m Files already downloaded and verified
    [2m[36m(pid=1483)[0m Files already downloaded and verified
    [2m[36m(pid=1490)[0m Files already downloaded and verified
    [2m[36m(pid=1477)[0m Files already downloaded and verified
    [2m[36m(pid=1479)[0m Files already downloaded and verified
    [2m[36m(pid=1482)[0m Files already downloaded and verified
    [2m[36m(pid=1501)[0m Files already downloaded and verified
    [2m[36m(pid=1492)[0m Files already downloaded and verified
    [2m[36m(pid=1489)[0m Files already downloaded and verified
    [2m[36m(pid=1462)[0m Files already downloaded and verified
    [2m[36m(pid=1502)[0m Files already downloaded and verified
    [2m[36m(pid=1483)[0m Files already downloaded and verified
    [2m[36m(pid=1490)[0m Files already downloaded and verified
    [2m[36m(pid=1477)[0m Files already downloaded and verified
    [2m[36m(pid=1479)[0m Files already downloaded and verified
    [2m[36m(pid=1482)[0m Files already downloaded and verified
    [2m[36m(pid=1501)[0m [1,  2000] loss: 2.274
    [2m[36m(pid=1492)[0m [1,  2000] loss: 2.383
    [2m[36m(pid=1502)[0m [1,  2000] loss: 2.316
    [2m[36m(pid=1479)[0m [1,  2000] loss: 1.983
    [2m[36m(pid=1482)[0m [1,  2000] loss: 2.090
    [2m[36m(pid=1489)[0m [1,  2000] loss: 2.128
    [2m[36m(pid=1462)[0m [1,  2000] loss: 2.319
    [2m[36m(pid=1477)[0m [1,  2000] loss: 1.958
    [2m[36m(pid=1490)[0m [1,  2000] loss: 2.267
    [2m[36m(pid=1483)[0m [1,  2000] loss: 2.284
    [2m[36m(pid=1501)[0m [1,  4000] loss: 1.006
    [2m[36m(pid=1492)[0m [1,  4000] loss: 1.188
    [2m[36m(pid=1502)[0m [1,  4000] loss: 1.160
    Result for DEFAULT_453e7_00001:
      accuracy: 0.2872
      date: 2021-09-27_22-36-20
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 1.847062264442444
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 27.08711814880371
      time_this_iter_s: 27.08711814880371
      time_total_s: 27.08711814880371
      timestamp: 1632782180
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 9.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=0
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -1.847062264442444
    Resources requested: 20.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (10 RUNNING)
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status   | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING  |                 |            2 |   32 |    4 | 0.00154224  |         |            |                      |
    | DEFAULT_453e7_00001 | RUNNING  | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.84706 |     0.2872 |                    1 |
    | DEFAULT_453e7_00002 | RUNNING  |                 |           16 |   32 |    4 | 0.000805139 |         |            |                      |
    | DEFAULT_453e7_00003 | RUNNING  |                 |           16 |    4 |    8 | 0.000341209 |         |            |                      |
    | DEFAULT_453e7_00004 | RUNNING  |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00005 | RUNNING  |                 |            2 |   32 |   16 | 0.0693658   |         |            |                      |
    | DEFAULT_453e7_00006 | RUNNING  |                 |            8 |  256 |   32 | 0.0254171   |         |            |                      |
    | DEFAULT_453e7_00007 | RUNNING  |                 |            8 |  256 |   32 | 0.0275459   |         |            |                      |
    | DEFAULT_453e7_00008 | RUNNING  |                 |           16 |  128 |  256 | 0.000395593 |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING  |                 |            8 |    8 |   32 | 0.00910716  |         |            |                      |
    +---------------------+----------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_453e7_00003:
      accuracy: 0.0943
      date: 2021-09-27_22-36-20
      done: true
      experiment_id: 4e448b91ff67478997ae6ff469e5fb0e
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.306563349533081
      node_ip: 172.17.0.2
      pid: 1462
      should_checkpoint: true
      time_since_restore: 27.088256120681763
      time_this_iter_s: 27.088256120681763
      time_total_s: 27.088256120681763
      timestamp: 1632782180
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00003
  
    Result for DEFAULT_453e7_00002:
      accuracy: 0.1817
      date: 2021-09-27_22-36-21
      done: false
      experiment_id: 101900fbf37c46c1b887bb01f5106017
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.057362052345276
      node_ip: 172.17.0.2
      pid: 1490
      should_checkpoint: true
      time_since_restore: 27.681636333465576
      time_this_iter_s: 27.681636333465576
      time_total_s: 27.681636333465576
      timestamp: 1632782181
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00002
  
    Result for DEFAULT_453e7_00008:
      accuracy: 0.234
      date: 2021-09-27_22-36-22
      done: true
      experiment_id: 78ce2cee90c444f79e852ada07d7a6a0
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.099570951652527
      node_ip: 172.17.0.2
      pid: 1483
      should_checkpoint: true
      time_since_restore: 28.464794635772705
      time_this_iter_s: 28.464794635772705
      time_total_s: 28.464794635772705
      timestamp: 1632782182
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00008
  
    [2m[36m(pid=1479)[0m [1,  4000] loss: 0.894
    [2m[36m(pid=1482)[0m [1,  4000] loss: 1.025
    [2m[36m(pid=1489)[0m [1,  4000] loss: 1.048
    [2m[36m(pid=1501)[0m [1,  6000] loss: 0.643
    [2m[36m(pid=1492)[0m [1,  6000] loss: 0.796
    [2m[36m(pid=1502)[0m [1,  6000] loss: 0.773
    Result for DEFAULT_453e7_00009:
      accuracy: 0.379
      date: 2021-09-27_22-36-32
      done: false
      experiment_id: d64cd44976ac43a2ae21d34c6061b154
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 1.707063111448288
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 38.415523290634155
      time_this_iter_s: 38.415523290634155
      time_total_s: 38.415523290634155
      timestamp: 1632782192
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00009
  
    == Status ==
    Memory usage on this node: 8.2/240.1 GiB
    Using AsyncHyperBand: num_stopped=2
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: None | Iter 1.000: -2.057362052345276
    Resources requested: 16.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (8 RUNNING, 2 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.00154224  |         |            |                      |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.84706 |     0.2872 |                    1 |
    | DEFAULT_453e7_00002 | RUNNING    | 172.17.0.2:1490 |           16 |   32 |    4 | 0.000805139 | 2.05736 |     0.1817 |                    1 |
    | DEFAULT_453e7_00004 | RUNNING    |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00005 | RUNNING    |                 |            2 |   32 |   16 | 0.0693658   |         |            |                      |
    | DEFAULT_453e7_00006 | RUNNING    |                 |            8 |  256 |   32 | 0.0254171   |         |            |                      |
    | DEFAULT_453e7_00007 | RUNNING    |                 |            8 |  256 |   32 | 0.0275459   |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.70706 |     0.379  |                    1 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1477)[0m [2,  2000] loss: 1.758
    [2m[36m(pid=1501)[0m [1,  8000] loss: 0.454
    [2m[36m(pid=1490)[0m [2,  2000] loss: 1.927
    Result for DEFAULT_453e7_00006:
      accuracy: 0.1838
      date: 2021-09-27_22-36-35
      done: true
      experiment_id: 61f1758819614684b9fc5013ac854bf6
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.138050558567047
      node_ip: 172.17.0.2
      pid: 1482
      should_checkpoint: true
      time_since_restore: 42.177468061447144
      time_this_iter_s: 42.177468061447144
      time_total_s: 42.177468061447144
      timestamp: 1632782195
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00006
  
    [2m[36m(pid=1492)[0m [1,  8000] loss: 0.594
    [2m[36m(pid=1502)[0m [1,  8000] loss: 0.580
    Result for DEFAULT_453e7_00007:
      accuracy: 0.1492
      date: 2021-09-27_22-36-36
      done: true
      experiment_id: 46693ed75f1a46599a6b95b4d861f10a
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.2149784363746643
      node_ip: 172.17.0.2
      pid: 1489
      should_checkpoint: true
      time_since_restore: 43.18216609954834
      time_this_iter_s: 43.18216609954834
      time_total_s: 43.18216609954834
      timestamp: 1632782196
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00007
  
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3425
      date: 2021-09-27_22-36-40
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 2
      loss: 1.7219708723068237
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 46.43761396408081
      time_this_iter_s: 19.3504958152771
      time_total_s: 46.43761396408081
      timestamp: 1632782200
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 7.0/240.1 GiB
    Using AsyncHyperBand: num_stopped=4
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.7219708723068237 | Iter 1.000: -2.099570951652527
    Resources requested: 12.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (6 RUNNING, 4 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.00154224  |         |            |                      |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.72197 |     0.3425 |                    2 |
    | DEFAULT_453e7_00002 | RUNNING    | 172.17.0.2:1490 |           16 |   32 |    4 | 0.000805139 | 2.05736 |     0.1817 |                    1 |
    | DEFAULT_453e7_00004 | RUNNING    |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00005 | RUNNING    |                 |            2 |   32 |   16 | 0.0693658   |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.70706 |     0.379  |                    1 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_453e7_00002:
      accuracy: 0.2891
      date: 2021-09-27_22-36-41
      done: true
      experiment_id: 101900fbf37c46c1b887bb01f5106017
      hostname: b3b54393569d
      iterations_since_restore: 2
      loss: 1.7747916078567505
      node_ip: 172.17.0.2
      pid: 1490
      should_checkpoint: true
      time_since_restore: 47.33895969390869
      time_this_iter_s: 19.657323360443115
      time_total_s: 47.33895969390869
      timestamp: 1632782201
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 453e7_00002
  
    [2m[36m(pid=1501)[0m [1, 10000] loss: 0.350
    [2m[36m(pid=1479)[0m [2,  2000] loss: 1.753
    [2m[36m(pid=1492)[0m [1, 10000] loss: 0.478
    [2m[36m(pid=1502)[0m [1, 10000] loss: 0.464
    [2m[36m(pid=1501)[0m [1, 12000] loss: 0.289
    [2m[36m(pid=1479)[0m [2,  4000] loss: 0.873
    [2m[36m(pid=1492)[0m [1, 12000] loss: 0.396
    [2m[36m(pid=1502)[0m [1, 12000] loss: 0.387
    [2m[36m(pid=1477)[0m [3,  2000] loss: 1.728
    [2m[36m(pid=1501)[0m [1, 14000] loss: 0.241
    [2m[36m(pid=1492)[0m [1, 14000] loss: 0.340
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3205
      date: 2021-09-27_22-36-59
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 3
      loss: 1.71418656539917
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 66.27295207977295
      time_this_iter_s: 19.83533811569214
      time_total_s: 66.27295207977295
      timestamp: 1632782219
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: None | Iter 2.000: -1.748381240081787 | Iter 1.000: -2.099570951652527
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.00154224  |         |            |                      |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.71419 |     0.3205 |                    3 |
    | DEFAULT_453e7_00004 | RUNNING    |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00005 | RUNNING    |                 |            2 |   32 |   16 | 0.0693658   |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.70706 |     0.379  |                    1 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1502)[0m [1, 14000] loss: 0.331
    Result for DEFAULT_453e7_00009:
      accuracy: 0.3687
      date: 2021-09-27_22-37-01
      done: false
      experiment_id: d64cd44976ac43a2ae21d34c6061b154
      hostname: b3b54393569d
      iterations_since_restore: 2
      loss: 1.7282094254016875
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 67.38034105300903
      time_this_iter_s: 28.964817762374878
      time_total_s: 67.38034105300903
      timestamp: 1632782221
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 453e7_00009
  
    [2m[36m(pid=1501)[0m [1, 16000] loss: 0.211
    [2m[36m(pid=1492)[0m [1, 16000] loss: 0.297
    [2m[36m(pid=1502)[0m [1, 16000] loss: 0.290
    [2m[36m(pid=1479)[0m [3,  2000] loss: 1.738
    [2m[36m(pid=1501)[0m [1, 18000] loss: 0.186
    [2m[36m(pid=1477)[0m [4,  2000] loss: 1.717
    [2m[36m(pid=1492)[0m [1, 18000] loss: 0.264
    [2m[36m(pid=1502)[0m [1, 18000] loss: 0.258
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3725
      date: 2021-09-27_22-37-17
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 4
      loss: 1.6408680918693543
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 83.92251110076904
      time_this_iter_s: 17.649559020996094
      time_total_s: 83.92251110076904
      timestamp: 1632782237
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 6.4/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.099570951652527
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.00154224  |         |            |                      |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.64087 |     0.3725 |                    4 |
    | DEFAULT_453e7_00004 | RUNNING    |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00005 | RUNNING    |                 |            2 |   32 |   16 | 0.0693658   |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.72821 |     0.3687 |                    2 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [1, 20000] loss: 0.165
    [2m[36m(pid=1479)[0m [3,  4000] loss: 0.865
    [2m[36m(pid=1492)[0m [1, 20000] loss: 0.238
    [2m[36m(pid=1502)[0m [1, 20000] loss: 0.232
    Result for DEFAULT_453e7_00009:
      accuracy: 0.3606
      date: 2021-09-27_22-37-28
      done: false
      experiment_id: d64cd44976ac43a2ae21d34c6061b154
      hostname: b3b54393569d
      iterations_since_restore: 3
      loss: 1.7564130661964417
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 95.18426203727722
      time_this_iter_s: 27.80392098426819
      time_total_s: 95.18426203727722
      timestamp: 1632782248
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 453e7_00009
  
    == Status ==
    Memory usage on this node: 6.5/240.1 GiB
    Using AsyncHyperBand: num_stopped=5
    Bracket: Iter 8.000: None | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.099570951652527
    Resources requested: 10.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (5 RUNNING, 5 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    |                 |            2 |   32 |    4 | 0.00154224  |         |            |                      |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.64087 |     0.3725 |                    4 |
    | DEFAULT_453e7_00004 | RUNNING    |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00005 | RUNNING    |                 |            2 |   32 |   16 | 0.0693658   |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.75641 |     0.3606 |                    3 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_453e7_00000:
      accuracy: 0.382
      date: 2021-09-27_22-37-30
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 1.6035054826766253
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 96.43233442306519
      time_this_iter_s: 96.43233442306519
      time_total_s: 96.43233442306519
      timestamp: 1632782250
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00000
  
    [2m[36m(pid=1477)[0m [5,  2000] loss: 1.718
    Result for DEFAULT_453e7_00005:
      accuracy: 0.1002
      date: 2021-09-27_22-37-33
      done: true
      experiment_id: eb221e1f45ac4176810c7b6b88c1003a
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.3475368145227433
      node_ip: 172.17.0.2
      pid: 1492
      should_checkpoint: true
      time_since_restore: 99.70206141471863
      time_this_iter_s: 99.70206141471863
      time_total_s: 99.70206141471863
      timestamp: 1632782253
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00005
  
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3403
      date: 2021-09-27_22-37-35
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 5
      loss: 1.770144732093811
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 101.85970044136047
      time_this_iter_s: 17.93718934059143
      time_total_s: 101.85970044136047
      timestamp: 1632782255
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 5.9/240.1 GiB
    Using AsyncHyperBand: num_stopped=6
    Bracket: Iter 8.000: None | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.099570951652527
    Resources requested: 8.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (4 RUNNING, 6 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.60351 |     0.382  |                    1 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.77014 |     0.3403 |                    5 |
    | DEFAULT_453e7_00004 | RUNNING    |                 |            2 |   16 |  256 | 0.015179    |         |            |                      |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.75641 |     0.3606 |                    3 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_453e7_00004:
      accuracy: 0.0929
      date: 2021-09-27_22-37-36
      done: true
      experiment_id: f2826d32844d431095a03da663958969
      hostname: b3b54393569d
      iterations_since_restore: 1
      loss: 2.316391726064682
      node_ip: 172.17.0.2
      pid: 1502
      should_checkpoint: true
      time_since_restore: 102.62318706512451
      time_this_iter_s: 102.62318706512451
      time_total_s: 102.62318706512451
      timestamp: 1632782256
      timesteps_since_restore: 0
      training_iteration: 1
      trial_id: 453e7_00004
  
    [2m[36m(pid=1501)[0m [2,  2000] loss: 1.631
    [2m[36m(pid=1479)[0m [4,  2000] loss: 1.705
    [2m[36m(pid=1501)[0m [2,  4000] loss: 0.814
    [2m[36m(pid=1479)[0m [4,  4000] loss: 0.861
    [2m[36m(pid=1477)[0m [6,  2000] loss: 1.727
    [2m[36m(pid=1501)[0m [2,  6000] loss: 0.549
    Result for DEFAULT_453e7_00001:
      accuracy: 0.33
      date: 2021-09-27_22-37-52
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 6
      loss: 1.831962361717224
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 118.92972493171692
      time_this_iter_s: 17.070024490356445
      time_total_s: 118.92972493171692
      timestamp: 1632782272
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 5.3/240.1 GiB
    Using AsyncHyperBand: num_stopped=7
    Bracket: Iter 8.000: None | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.118810755109787
    Resources requested: 6.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (3 RUNNING, 7 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.60351 |     0.382  |                    1 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.83196 |     0.33   |                    6 |
    | DEFAULT_453e7_00009 | RUNNING    | 172.17.0.2:1479 |            8 |    8 |   32 | 0.00910716  | 1.75641 |     0.3606 |                    3 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_453e7_00009:
      accuracy: 0.4015
      date: 2021-09-27_22-37-55
      done: true
      experiment_id: d64cd44976ac43a2ae21d34c6061b154
      hostname: b3b54393569d
      iterations_since_restore: 4
      loss: 1.7011459294319153
      node_ip: 172.17.0.2
      pid: 1479
      should_checkpoint: true
      time_since_restore: 121.49442601203918
      time_this_iter_s: 26.310163974761963
      time_total_s: 121.49442601203918
      timestamp: 1632782275
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 453e7_00009
  
    [2m[36m(pid=1501)[0m [2,  8000] loss: 0.401
    [2m[36m(pid=1477)[0m [7,  2000] loss: 1.756
    [2m[36m(pid=1501)[0m [2, 10000] loss: 0.323
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3532
      date: 2021-09-27_22-38-09
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 7
      loss: 1.7230993372917176
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 135.92367339134216
      time_this_iter_s: 16.993948459625244
      time_total_s: 135.92367339134216
      timestamp: 1632782289
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: None | Iter 4.000: -1.671007010650635 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.118810755109787
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.60351 |     0.382  |                    1 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.7231  |     0.3532 |                    7 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [2, 12000] loss: 0.263
    [2m[36m(pid=1501)[0m [2, 14000] loss: 0.225
    [2m[36m(pid=1477)[0m [8,  2000] loss: 1.744
    [2m[36m(pid=1501)[0m [2, 16000] loss: 0.198
    Result for DEFAULT_453e7_00001:
      accuracy: 0.2915
      date: 2021-09-27_22-38-28
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 8
      loss: 1.843651125717163
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 154.51575708389282
      time_this_iter_s: 18.59208369255066
      time_total_s: 154.51575708389282
      timestamp: 1632782308
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.671007010650635 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.118810755109787
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.60351 |     0.382  |                    1 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.84365 |     0.2915 |                    8 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [2, 18000] loss: 0.173
    [2m[36m(pid=1477)[0m [9,  2000] loss: 1.767
    [2m[36m(pid=1501)[0m [2, 20000] loss: 0.158
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3525
      date: 2021-09-27_22-38-44
      done: false
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 9
      loss: 1.6759143730163575
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 171.16540145874023
      time_this_iter_s: 16.649644374847412
      time_total_s: 171.16540145874023
      timestamp: 1632782324
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.671007010650635 | Iter 2.000: -1.7282094254016875 | Iter 1.000: -2.118810755109787
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.60351 |     0.382  |                    1 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.67591 |     0.3525 |                    9 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    Result for DEFAULT_453e7_00000:
      accuracy: 0.4309
      date: 2021-09-27_22-38-50
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 2
      loss: 1.5342508313700556
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 177.33070755004883
      time_this_iter_s: 80.89837312698364
      time_total_s: 177.33070755004883
      timestamp: 1632782330
      timesteps_since_restore: 0
      training_iteration: 2
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=8
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.671007010650635 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.53425 |     0.4309 |                    2 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.67591 |     0.3525 |                    9 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1477)[0m [10,  2000] loss: 1.737
    [2m[36m(pid=1501)[0m [3,  2000] loss: 1.538
    Result for DEFAULT_453e7_00001:
      accuracy: 0.3345
      date: 2021-09-27_22-39-01
      done: true
      experiment_id: 1bba3f802b9640cfb4724056e6864ca2
      hostname: b3b54393569d
      iterations_since_restore: 10
      loss: 1.7796123226165772
      node_ip: 172.17.0.2
      pid: 1477
      should_checkpoint: true
      time_since_restore: 187.95423007011414
      time_this_iter_s: 16.7888286113739
      time_total_s: 187.95423007011414
      timestamp: 1632782341
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 453e7_00001
  
    == Status ==
    Memory usage on this node: 4.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.671007010650635 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 4.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (2 RUNNING, 8 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.53425 |     0.4309 |                    2 |
    | DEFAULT_453e7_00001 | RUNNING    | 172.17.0.2:1477 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [3,  4000] loss: 0.762
    [2m[36m(pid=1501)[0m [3,  6000] loss: 0.512
    [2m[36m(pid=1501)[0m [3,  8000] loss: 0.375
    [2m[36m(pid=1501)[0m [3, 10000] loss: 0.306
    [2m[36m(pid=1501)[0m [3, 12000] loss: 0.251
    [2m[36m(pid=1501)[0m [3, 14000] loss: 0.218
    [2m[36m(pid=1501)[0m [3, 16000] loss: 0.190
    [2m[36m(pid=1501)[0m [3, 18000] loss: 0.168
    [2m[36m(pid=1501)[0m [3, 20000] loss: 0.150
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4704
      date: 2021-09-27_22-40-07
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 3
      loss: 1.4782821337949485
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 253.5741045475006
      time_this_iter_s: 76.24339699745178
      time_total_s: 253.5741045475006
      timestamp: 1632782407
      timesteps_since_restore: 0
      training_iteration: 3
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.671007010650635 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.47828 |     0.4704 |                    3 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [4,  2000] loss: 1.492
    [2m[36m(pid=1501)[0m [4,  4000] loss: 0.745
    [2m[36m(pid=1501)[0m [4,  6000] loss: 0.497
    [2m[36m(pid=1501)[0m [4,  8000] loss: 0.363
    [2m[36m(pid=1501)[0m [4, 10000] loss: 0.294
    [2m[36m(pid=1501)[0m [4, 12000] loss: 0.244
    [2m[36m(pid=1501)[0m [4, 14000] loss: 0.212
    [2m[36m(pid=1501)[0m [4, 16000] loss: 0.188
    [2m[36m(pid=1501)[0m [4, 18000] loss: 0.166
    [2m[36m(pid=1501)[0m [4, 20000] loss: 0.149
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4565
      date: 2021-09-27_22-41-22
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 4
      loss: 1.4984065249666572
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 329.18347001075745
      time_this_iter_s: 75.60936546325684
      time_total_s: 329.18347001075745
      timestamp: 1632782482
      timesteps_since_restore: 0
      training_iteration: 4
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.49841 |     0.4565 |                    4 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [5,  2000] loss: 1.446
    [2m[36m(pid=1501)[0m [5,  4000] loss: 0.741
    [2m[36m(pid=1501)[0m [5,  6000] loss: 0.477
    [2m[36m(pid=1501)[0m [5,  8000] loss: 0.368
    [2m[36m(pid=1501)[0m [5, 10000] loss: 0.284
    [2m[36m(pid=1501)[0m [5, 12000] loss: 0.240
    [2m[36m(pid=1501)[0m [5, 14000] loss: 0.211
    [2m[36m(pid=1501)[0m [5, 16000] loss: 0.186
    [2m[36m(pid=1501)[0m [5, 18000] loss: 0.163
    [2m[36m(pid=1501)[0m [5, 20000] loss: 0.145
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4621
      date: 2021-09-27_22-42-37
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 5
      loss: 1.477190755239688
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 404.22085547447205
      time_this_iter_s: 75.0373854637146
      time_total_s: 404.22085547447205
      timestamp: 1632782557
      timesteps_since_restore: 0
      training_iteration: 5
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.47719 |     0.4621 |                    5 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [6,  2000] loss: 1.405
    [2m[36m(pid=1501)[0m [6,  4000] loss: 0.705
    [2m[36m(pid=1501)[0m [6,  6000] loss: 0.482
    [2m[36m(pid=1501)[0m [6,  8000] loss: 0.359
    [2m[36m(pid=1501)[0m [6, 10000] loss: 0.283
    [2m[36m(pid=1501)[0m [6, 12000] loss: 0.239
    [2m[36m(pid=1501)[0m [6, 14000] loss: 0.211
    [2m[36m(pid=1501)[0m [6, 16000] loss: 0.184
    [2m[36m(pid=1501)[0m [6, 18000] loss: 0.161
    [2m[36m(pid=1501)[0m [6, 20000] loss: 0.147
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4717
      date: 2021-09-27_22-43-54
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 6
      loss: 1.460341798269935
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 480.95450162887573
      time_this_iter_s: 76.73364615440369
      time_total_s: 480.95450162887573
      timestamp: 1632782634
      timesteps_since_restore: 0
      training_iteration: 6
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.46034 |     0.4717 |                    6 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [7,  2000] loss: 1.390
    [2m[36m(pid=1501)[0m [7,  4000] loss: 0.698
    [2m[36m(pid=1501)[0m [7,  6000] loss: 0.475
    [2m[36m(pid=1501)[0m [7,  8000] loss: 0.356
    [2m[36m(pid=1501)[0m [7, 10000] loss: 0.289
    [2m[36m(pid=1501)[0m [7, 12000] loss: 0.240
    [2m[36m(pid=1501)[0m [7, 14000] loss: 0.203
    [2m[36m(pid=1501)[0m [7, 16000] loss: 0.178
    [2m[36m(pid=1501)[0m [7, 18000] loss: 0.163
    [2m[36m(pid=1501)[0m [7, 20000] loss: 0.147
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4489
      date: 2021-09-27_22-45-10
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 7
      loss: 1.482682123292354
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 556.5338931083679
      time_this_iter_s: 75.57939147949219
      time_total_s: 556.5338931083679
      timestamp: 1632782710
      timesteps_since_restore: 0
      training_iteration: 7
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.843651125717163 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.48268 |     0.4489 |                    7 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [8,  2000] loss: 1.380
    [2m[36m(pid=1501)[0m [8,  4000] loss: 0.694
    [2m[36m(pid=1501)[0m [8,  6000] loss: 0.471
    [2m[36m(pid=1501)[0m [8,  8000] loss: 0.346
    [2m[36m(pid=1501)[0m [8, 10000] loss: 0.283
    [2m[36m(pid=1501)[0m [8, 12000] loss: 0.237
    [2m[36m(pid=1501)[0m [8, 14000] loss: 0.207
    [2m[36m(pid=1501)[0m [8, 16000] loss: 0.183
    [2m[36m(pid=1501)[0m [8, 18000] loss: 0.161
    [2m[36m(pid=1501)[0m [8, 20000] loss: 0.144
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4743
      date: 2021-09-27_22-46-25
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 8
      loss: 1.477873087131139
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 631.989839553833
      time_this_iter_s: 75.45594644546509
      time_total_s: 631.989839553833
      timestamp: 1632782785
      timesteps_since_restore: 0
      training_iteration: 8
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.660762106424151 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.47787 |     0.4743 |                    8 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [9,  2000] loss: 1.373
    [2m[36m(pid=1501)[0m [9,  4000] loss: 0.719
    [2m[36m(pid=1501)[0m [9,  6000] loss: 0.459
    [2m[36m(pid=1501)[0m [9,  8000] loss: 0.353
    [2m[36m(pid=1501)[0m [9, 10000] loss: 0.292
    [2m[36m(pid=1501)[0m [9, 12000] loss: 0.242
    [2m[36m(pid=1501)[0m [9, 14000] loss: 0.210
    [2m[36m(pid=1501)[0m [9, 16000] loss: 0.180
    [2m[36m(pid=1501)[0m [9, 18000] loss: 0.158
    [2m[36m(pid=1501)[0m [9, 20000] loss: 0.145
    Result for DEFAULT_453e7_00000:
      accuracy: 0.5019
      date: 2021-09-27_22-47-42
      done: false
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 9
      loss: 1.464529314908036
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 708.3722178936005
      time_this_iter_s: 76.38237833976746
      time_total_s: 708.3722178936005
      timestamp: 1632782862
      timesteps_since_restore: 0
      training_iteration: 9
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=9
    Bracket: Iter 8.000: -1.660762106424151 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.46453 |     0.5019 |                    9 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    [2m[36m(pid=1501)[0m [10,  2000] loss: 1.391
    [2m[36m(pid=1501)[0m [10,  4000] loss: 0.714
    [2m[36m(pid=1501)[0m [10,  6000] loss: 0.476
    [2m[36m(pid=1501)[0m [10,  8000] loss: 0.349
    [2m[36m(pid=1501)[0m [10, 10000] loss: 0.292
    [2m[36m(pid=1501)[0m [10, 12000] loss: 0.240
    [2m[36m(pid=1501)[0m [10, 14000] loss: 0.207
    [2m[36m(pid=1501)[0m [10, 16000] loss: 0.175
    [2m[36m(pid=1501)[0m [10, 18000] loss: 0.161
    [2m[36m(pid=1501)[0m [10, 20000] loss: 0.143
    Result for DEFAULT_453e7_00000:
      accuracy: 0.4834
      date: 2021-09-27_22-48-58
      done: true
      experiment_id: 9ffeba80becc401ea0a15d42ed15be9d
      hostname: b3b54393569d
      iterations_since_restore: 10
      loss: 1.4891251817219715
      node_ip: 172.17.0.2
      pid: 1501
      should_checkpoint: true
      time_since_restore: 784.9103989601135
      time_this_iter_s: 76.53818106651306
      time_total_s: 784.9103989601135
      timestamp: 1632782938
      timesteps_since_restore: 0
      training_iteration: 10
      trial_id: 453e7_00000
  
    == Status ==
    Memory usage on this node: 4.1/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.660762106424151 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 2.0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (1 RUNNING, 9 TERMINATED)
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc             |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | RUNNING    | 172.17.0.2:1501 |            2 |   32 |    4 | 0.00154224  | 1.48913 |     0.4834 |                   10 |
    | DEFAULT_453e7_00001 | TERMINATED |                 |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |                 |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |                 |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |                 |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |                 |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |                 |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |                 |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |                 |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |                 |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-----------------+--------------+------+------+-------------+---------+------------+----------------------+


    == Status ==
    Memory usage on this node: 3.7/240.1 GiB
    Using AsyncHyperBand: num_stopped=10
    Bracket: Iter 8.000: -1.660762106424151 | Iter 4.000: -1.6408680918693543 | Iter 2.000: -1.7250901488542556 | Iter 1.000: -2.118810755109787
    Resources requested: 0/32 CPUs, 0/2 GPUs, 0.0/220.17 GiB heap, 0.0/9.31 GiB objects (0.0/1.0 accelerator_type:M60)
    Result logdir: /var/lib/jenkins/ray_results/DEFAULT_2021-09-27_22-35-52
    Number of trials: 10/10 (10 TERMINATED)
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+
    | Trial name          | status     | loc   |   batch_size |   l1 |   l2 |          lr |    loss |   accuracy |   training_iteration |
    |---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------|
    | DEFAULT_453e7_00000 | TERMINATED |       |            2 |   32 |    4 | 0.00154224  | 1.48913 |     0.4834 |                   10 |
    | DEFAULT_453e7_00001 | TERMINATED |       |           16 |    4 |  256 | 0.0148798   | 1.77961 |     0.3345 |                   10 |
    | DEFAULT_453e7_00002 | TERMINATED |       |           16 |   32 |    4 | 0.000805139 | 1.77479 |     0.2891 |                    2 |
    | DEFAULT_453e7_00003 | TERMINATED |       |           16 |    4 |    8 | 0.000341209 | 2.30656 |     0.0943 |                    1 |
    | DEFAULT_453e7_00004 | TERMINATED |       |            2 |   16 |  256 | 0.015179    | 2.31639 |     0.0929 |                    1 |
    | DEFAULT_453e7_00005 | TERMINATED |       |            2 |   32 |   16 | 0.0693658   | 2.34754 |     0.1002 |                    1 |
    | DEFAULT_453e7_00006 | TERMINATED |       |            8 |  256 |   32 | 0.0254171   | 2.13805 |     0.1838 |                    1 |
    | DEFAULT_453e7_00007 | TERMINATED |       |            8 |  256 |   32 | 0.0275459   | 2.21498 |     0.1492 |                    1 |
    | DEFAULT_453e7_00008 | TERMINATED |       |           16 |  128 |  256 | 0.000395593 | 2.09957 |     0.234  |                    1 |
    | DEFAULT_453e7_00009 | TERMINATED |       |            8 |    8 |   32 | 0.00910716  | 1.70115 |     0.4015 |                    4 |
    +---------------------+------------+-------+--------------+------+------+-------------+---------+------------+----------------------+


    Best trial config: {'l1': 32, 'l2': 4, 'lr': 0.0015422437921605275, 'batch_size': 2}
    Best trial final validation loss: 1.4891251817219715
    Best trial final validation accuracy: 0.4834
    Files already downloaded and verified
    Files already downloaded and verified
    Best trial test set accuracy: 0.4853


If you run the code, an example output could look like this:

::

    Number of trials: 10 (10 TERMINATED)
    +-----+------+------+-------------+--------------+---------+------------+--------------------+
    | ... |   l1 |   l2 |          lr |   batch_size |    loss |   accuracy | training_iteration |
    |-----+------+------+-------------+--------------+---------+------------+--------------------|
    | ... |   64 |    4 | 0.00011629  |            2 | 1.87273 |     0.244  |                  2 |
    | ... |   32 |   64 | 0.000339763 |            8 | 1.23603 |     0.567  |                  8 |
    | ... |    8 |   16 | 0.00276249  |           16 | 1.1815  |     0.5836 |                 10 |
    | ... |    4 |   64 | 0.000648721 |            4 | 1.31131 |     0.5224 |                  8 |
    | ... |   32 |   16 | 0.000340753 |            8 | 1.26454 |     0.5444 |                  8 |
    | ... |    8 |    4 | 0.000699775 |            8 | 1.99594 |     0.1983 |                  2 |
    | ... |  256 |    8 | 0.0839654   |           16 | 2.3119  |     0.0993 |                  1 |
    | ... |   16 |  128 | 0.0758154   |           16 | 2.33575 |     0.1327 |                  1 |
    | ... |   16 |    8 | 0.0763312   |           16 | 2.31129 |     0.1042 |                  4 |
    | ... |  128 |   16 | 0.000124903 |            4 | 2.26917 |     0.1945 |                  1 |
    +-----+------+------+-------------+--------------+---------+------------+--------------------+


    Best trial config: {'l1': 8, 'l2': 16, 'lr': 0.00276249, 'batch_size': 16, 'data_dir': '...'}
    Best trial final validation loss: 1.181501
    Best trial final validation accuracy: 0.5836
    Best trial test set accuracy: 0.5806

Most trials have been stopped early in order to avoid wasting resources.
The best performing trial achieved a validation accuracy of about 58%, which could
be confirmed on the test set.

So that's it! You can now tune the parameters of your PyTorch models.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 13 minutes  32.505 seconds)


.. _sphx_glr_download_beginner_hyperparameter_tuning_tutorial.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: hyperparameter_tuning_tutorial.py <hyperparameter_tuning_tutorial.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: hyperparameter_tuning_tutorial.ipynb <hyperparameter_tuning_tutorial.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.readthedocs.io>`_
